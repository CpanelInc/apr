diff -apruN apr-1.5.2.orig/time/unix/time.c apr-1.5.2/time/unix/time.c
--- apr-1.5.2.orig/time/unix/time.c	2006-08-03 13:55:31.000000000 +0300
+++ apr-1.5.2/time/unix/time.c	2017-11-29 11:04:45.480356730 +0200
@@ -142,6 +142,9 @@ APR_DECLARE(apr_status_t) apr_time_exp_g
     static const int dayoffset[12] =
     {306, 337, 0, 31, 61, 92, 122, 153, 184, 214, 245, 275};
 
+    if (xt->tm_mon < 0 || xt->tm_mon >= 12)
+        return APR_EBADDATE;
+
     /* shift new year to 1st March in order to make leap year calc easy */
 
     if (xt->tm_mon < 2)
diff -apruN apr-1.5.2.orig/time/win32/time.c apr-1.5.2/time/win32/time.c
--- apr-1.5.2.orig/time/win32/time.c	2012-08-12 00:04:05.000000000 +0300
+++ apr-1.5.2/time/win32/time.c	2017-11-29 11:06:10.117401454 +0200
@@ -54,6 +54,9 @@ static void SystemTimeToAprExpTime(apr_t
     static const int dayoffset[12] =
     {0, 31, 59, 90, 120, 151, 181, 212, 243, 273, 304, 334};
 
+    if (tm->wMonth < 1 || tm->wMonth > 12)
+        return APR_EBADDATE;
+
     /* Note; the caller is responsible for filling in detailed tm_usec,
      * tm_gmtoff and tm_isdst data when applicable.
      */
@@ -224,6 +227,9 @@ APR_DECLARE(apr_status_t) apr_time_exp_g
     static const int dayoffset[12] =
     {306, 337, 0, 31, 61, 92, 122, 153, 184, 214, 245, 275};
 
+    if (xt->tm_mon < 0 || xt->tm_mon >= 12)
+        return APR_EBADDATE;
+
     /* shift new year to 1st March in order to make leap year calc easy */
 
     if (xt->tm_mon < 2)
